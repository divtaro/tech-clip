@import "tailwindcss";

@theme {
  --color-background: 0 0% 100%;
  --color-foreground: 0 0% 3.9%;
  --color-card: 0 0% 100%;
  --color-card-foreground: 0 0% 3.9%;
  --color-popover: 0 0% 100%;
  --color-popover-foreground: 0 0% 3.9%;
  --color-primary: 221 83% 53%;
  --color-primary-foreground: 0 0% 98%;
  --color-secondary: 0 0% 96.1%;
  --color-secondary-foreground: 0 0% 9%;
  --color-muted: 0 0% 96.1%;
  --color-muted-foreground: 0 0% 45.1%;
  --color-accent: 0 0% 88%;
  --color-accent-foreground: 0 0% 9%;
  --color-destructive: 0 84.2% 60.2%;
  --color-destructive-foreground: 0 0% 98%;
  --color-border: 0 0% 85%;
  --color-input: 0 0% 85%;
  --color-ring: 221 83% 53%;
  --radius-lg: 0.5rem;
  --radius-md: calc(0.5rem - 2px);
  --radius-sm: calc(0.5rem - 4px);
}

:root {
  --background: var(--color-background);
  --foreground: var(--color-foreground);
  --card: var(--color-card);
  --card-foreground: var(--color-card-foreground);
  --popover: var(--color-popover);
  --popover-foreground: var(--color-popover-foreground);
  --primary: var(--color-primary);
  --primary-foreground: var(--color-primary-foreground);
  --secondary: var(--color-secondary);
  --secondary-foreground: var(--color-secondary-foreground);
  --muted: var(--color-muted);
  --muted-foreground: var(--color-muted-foreground);
  --accent: var(--color-accent);
  --accent-foreground: var(--color-accent-foreground);
  --destructive: var(--color-destructive);
  --destructive-foreground: var(--color-destructive-foreground);
  --border: var(--color-border);
  --input: var(--color-input);
  --ring: var(--color-ring);
  --radius: var(--radius-lg);
}

.dark {
  --color-background: 0 0% 3.9%;
  --color-foreground: 0 0% 98%;
  --color-card: 0 0% 3.9%;
  --color-card-foreground: 0 0% 98%;
  --color-popover: 0 0% 3.9%;
  --color-popover-foreground: 0 0% 98%;
  --color-primary: 221 83% 63%;
  --color-primary-foreground: 0 0% 98%;
  --color-secondary: 0 0% 14.9%;
  --color-secondary-foreground: 0 0% 98%;
  --color-muted: 0 0% 14.9%;
  --color-muted-foreground: 0 0% 63.9%;
  --color-accent: 0 0% 20%;
  --color-accent-foreground: 0 0% 98%;
  --color-destructive: 0 62.8% 30.6%;
  --color-destructive-foreground: 0 0% 98%;
  --color-border: 0 0% 25%;
  --color-input: 0 0% 25%;
  --color-ring: 221 83% 63%;
}

* {
  border-color: hsl(var(--border));
}

html {
  /* Let body be the scroll container to avoid iOS jump-to-top */
  height: 100%;
}

body {
  background-color: hsl(var(--background));
  color: hsl(var(--foreground));
  height: 100%;
  max-width: 100%;
  overflow-x: hidden;
  overflow-y: auto; /* Native momentum scroll on iOS */
  -webkit-overflow-scrolling: touch;
  /* Allow natural overscroll and pull-to-refresh */
}

/* (Reverted) no extra iOS-specific compositing tweaks */

/* モーダルとセレクトボックスの透過を防ぐ */
[role="dialog"],
[role="alertdialog"] {
  background-color: hsl(var(--popover)) !important;
  opacity: 1 !important;
}

/* ドロップダウンとセレクトボックスのコンテナ背景 */
[role="menu"],
[role="listbox"] {
  background-color: hsl(var(--popover));
}

.popover-content {
  background-color: hsl(var(--popover)) !important;
  opacity: 1 !important;
}

/* Placeholderの色を統一 */
::placeholder {
  color: hsl(var(--muted-foreground));
  opacity: 0.6;
}

/* フォーカス時の枠線をアクティブに */
input:focus,
textarea:focus,
select:focus {
  outline: none;
  border-color: hsl(var(--primary));
  box-shadow: 0 0 0 2px hsl(var(--primary) / 0.2);
}

/* Radix UI Select トリガーのオープン時スタイル */
button[data-state="open"] {
  border-color: hsl(var(--primary)) !important;
  box-shadow: 0 0 0 2px hsl(var(--primary) / 0.2) !important;
}

/* ボタンにカーソルポインター */
button,
[role="button"],
[type="button"],
[type="submit"] {
  cursor: pointer;
}

/* ドロップダウンメニューとセレクトボックスの項目ホバースタイル */
[role="menuitem"]:hover,
[role="option"]:hover {
  background-color: hsl(var(--accent)) !important;
  color: hsl(var(--accent-foreground)) !important;
}

/* ボタンのホバー/タップ時の視覚的フィードバック */
/* PC: ホバー時に色が変わる、スマホ: タップ時に色が変わる */

/* 全ボタン共通のトランジション */
button:not(:disabled),
[role="button"]:not(:disabled),
[type="button"]:not(:disabled),
[type="submit"]:not(:disabled),
a.inline-flex {
  transition: opacity 0.2s ease, transform 0.1s ease, background-color 0.2s ease;
}

/* PC: ホバー時に少し縮小（セレクトボックスのトリガーは除外） */
@media (hover: hover) and (pointer: fine) {
  button:hover:not(:disabled):not([role="combobox"]),
  [role="button"]:hover:not(:disabled):not([role="combobox"]),
  [type="button"]:hover:not(:disabled):not([role="combobox"]),
  [type="submit"]:hover:not(:disabled),
  a.inline-flex:hover {
    transform: scale(0.98);
  }

  /* プライマリー背景色のボタンをホバー時に少し薄く */
  button[style*="background-color"]:hover:not(:disabled) {
    opacity: 0.85;
  }

  /* Tailwindのprimaryバリアントを持つボタン */
  button.bg-primary:hover:not(:disabled),
  button[class*="bg-primary"]:hover:not(:disabled) {
    opacity: 0.85;
  }

  /* デストラクティブボタン（削除ボタンなど） */
  button[style*="hsl(0 84.2% 60.2%)"]:hover:not(:disabled) {
    opacity: 0.85;
  }

  /* ゴーストボタンとアウトラインボタン */
  button[class*="variant-ghost"]:hover:not(:disabled),
  button[class*="variant-outline"]:hover:not(:disabled),
  a.inline-flex:hover {
    background-color: hsl(var(--accent) / 0.5) !important;
  }
}

/* スマホ: タップ時に縮小と色変更 */
@media (hover: none) and (pointer: coarse) {
  button:active:not(:disabled),
  [role="button"]:active:not(:disabled),
  [type="button"]:active:not(:disabled),
  [type="submit"]:active:not(:disabled),
  a.inline-flex:active {
    transform: scale(0.98);
  }

  /* プライマリー背景色のボタンをタップ時に少し薄く */
  button[style*="background-color"]:active:not(:disabled) {
    opacity: 0.85;
  }

  /* Tailwindのprimaryバリアントを持つボタン */
  button.bg-primary:active:not(:disabled),
  button[class*="bg-primary"]:active:not(:disabled) {
    opacity: 0.85;
  }

  /* デストラクティブボタン（削除ボタンなど） */
  button[style*="hsl(0 84.2% 60.2%)"]:active:not(:disabled) {
    opacity: 0.85;
  }

  /* ゴーストボタンとアウトラインボタン */
  button[class*="variant-ghost"]:active:not(:disabled),
  button[class*="variant-outline"]:active:not(:disabled),
  a.inline-flex:active {
    background-color: hsl(var(--accent) / 0.5) !important;
  }
}

/* モバイル向けのタップハイライトを無効化（カスタムフィードバックを使用） */
button,
[role="button"],
[type="button"],
[type="submit"] {
  -webkit-tap-highlight-color: transparent;
}
